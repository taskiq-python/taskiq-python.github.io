import{_ as p}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as c,o as r,c as u,b as s,d as n,e as o,w as e}from"./app-Lulzgzf0.js";const k={},d=s("h1",{id:"middlewares",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#middlewares"},[s("span",null,"Middlewares")])],-1),m=s("p",null,"Middlewares are super helpful. You can inject some code before or after task's execution.",-1),b={href:"https://github.com/taskiq-python/taskiq/blob/master/taskiq/abc/middleware.py",target:"_blank",rel:"noopener noreferrer"},w=s("code",null,"taskiq.abc.middleware.TaskiqMiddleware",-1),y=s("p",null,"For example:",-1),v=s("div",{class:"language-python line-numbers-mode","data-ext":"py","data-title":"py"},[s("pre",{class:"language-python"},[s("code",null,[s("span",{class:"token keyword"},"from"),n(" time "),s("span",{class:"token keyword"},"import"),n(` sleep
`),s("span",{class:"token keyword"},"from"),n(" typing "),s("span",{class:"token keyword"},"import"),n(` Any

`),s("span",{class:"token keyword"},"from"),n(" taskiq "),s("span",{class:"token keyword"},"import"),n(" TaskiqMessage"),s("span",{class:"token punctuation"},","),n(" TaskiqMiddleware"),s("span",{class:"token punctuation"},","),n(` TaskiqResult


`),s("span",{class:"token keyword"},"class"),n(),s("span",{class:"token class-name"},"MyMiddleware"),s("span",{class:"token punctuation"},"("),n("TaskiqMiddleware"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},":"),n(`
    `),s("span",{class:"token keyword"},"def"),n(),s("span",{class:"token function"},"startup"),s("span",{class:"token punctuation"},"("),n("self"),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token operator"},"-"),s("span",{class:"token operator"},">"),n(),s("span",{class:"token boolean"},"None"),s("span",{class:"token punctuation"},":"),n(`
        `),s("span",{class:"token keyword"},"print"),s("span",{class:"token punctuation"},"("),s("span",{class:"token string"},'"RUN STARTUP"'),s("span",{class:"token punctuation"},")"),n(`
        sleep`),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),n(`

    `),s("span",{class:"token keyword"},"def"),n(),s("span",{class:"token function"},"shutdown"),s("span",{class:"token punctuation"},"("),n("self"),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token operator"},"-"),s("span",{class:"token operator"},">"),n(),s("span",{class:"token boolean"},"None"),s("span",{class:"token punctuation"},":"),n(`
        `),s("span",{class:"token keyword"},"print"),s("span",{class:"token punctuation"},"("),s("span",{class:"token string"},'"RUN SHUTDOWN"'),s("span",{class:"token punctuation"},")"),n(`
        sleep`),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),n(`

    `),s("span",{class:"token keyword"},"def"),n(),s("span",{class:"token function"},"pre_execute"),s("span",{class:"token punctuation"},"("),n("self"),s("span",{class:"token punctuation"},","),n(" message"),s("span",{class:"token punctuation"},":"),n(),s("span",{class:"token string"},'"TaskiqMessage"'),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token operator"},"-"),s("span",{class:"token operator"},">"),n(" TaskiqMessage"),s("span",{class:"token punctuation"},":"),n(`
        sleep`),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),n(`
        `),s("span",{class:"token keyword"},"return"),n(` message

    `),s("span",{class:"token keyword"},"def"),n(),s("span",{class:"token function"},"post_save"),s("span",{class:"token punctuation"},"("),n("self"),s("span",{class:"token punctuation"},","),n(" message"),s("span",{class:"token punctuation"},":"),n(),s("span",{class:"token string"},'"TaskiqMessage"'),s("span",{class:"token punctuation"},","),n(" result"),s("span",{class:"token punctuation"},":"),n(),s("span",{class:"token string"},'"TaskiqResult[Any]"'),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token operator"},"-"),s("span",{class:"token operator"},">"),n(),s("span",{class:"token boolean"},"None"),s("span",{class:"token punctuation"},":"),n(`
        sleep`),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),n(`
        `),s("span",{class:"token keyword"},"print"),s("span",{class:"token punctuation"},"("),s("span",{class:"token string"},'"Post save"'),s("span",{class:"token punctuation"},")"),n(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),f=s("div",{class:"language-python line-numbers-mode","data-ext":"py","data-title":"py"},[s("pre",{class:"language-python"},[s("code",null,[s("span",{class:"token keyword"},"from"),n(" asyncio "),s("span",{class:"token keyword"},"import"),n(` sleep
`),s("span",{class:"token keyword"},"from"),n(" typing "),s("span",{class:"token keyword"},"import"),n(` Any

`),s("span",{class:"token keyword"},"from"),n(" taskiq "),s("span",{class:"token keyword"},"import"),n(" TaskiqMessage"),s("span",{class:"token punctuation"},","),n(" TaskiqMiddleware"),s("span",{class:"token punctuation"},","),n(` TaskiqResult


`),s("span",{class:"token keyword"},"class"),n(),s("span",{class:"token class-name"},"MyMiddleware"),s("span",{class:"token punctuation"},"("),n("TaskiqMiddleware"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},":"),n(`
    `),s("span",{class:"token keyword"},"async"),n(),s("span",{class:"token keyword"},"def"),n(),s("span",{class:"token function"},"startup"),s("span",{class:"token punctuation"},"("),n("self"),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token operator"},"-"),s("span",{class:"token operator"},">"),n(),s("span",{class:"token boolean"},"None"),s("span",{class:"token punctuation"},":"),n(`
        `),s("span",{class:"token keyword"},"print"),s("span",{class:"token punctuation"},"("),s("span",{class:"token string"},'"RUN STARTUP"'),s("span",{class:"token punctuation"},")"),n(`
        `),s("span",{class:"token keyword"},"await"),n(" sleep"),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),n(`

    `),s("span",{class:"token keyword"},"async"),n(),s("span",{class:"token keyword"},"def"),n(),s("span",{class:"token function"},"shutdown"),s("span",{class:"token punctuation"},"("),n("self"),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token operator"},"-"),s("span",{class:"token operator"},">"),n(),s("span",{class:"token boolean"},"None"),s("span",{class:"token punctuation"},":"),n(`
        `),s("span",{class:"token keyword"},"print"),s("span",{class:"token punctuation"},"("),s("span",{class:"token string"},'"RUN SHUTDOWN"'),s("span",{class:"token punctuation"},")"),n(`
        `),s("span",{class:"token keyword"},"await"),n(" sleep"),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),n(`

    `),s("span",{class:"token keyword"},"async"),n(),s("span",{class:"token keyword"},"def"),n(),s("span",{class:"token function"},"pre_execute"),s("span",{class:"token punctuation"},"("),n("self"),s("span",{class:"token punctuation"},","),n(" message"),s("span",{class:"token punctuation"},":"),n(),s("span",{class:"token string"},'"TaskiqMessage"'),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token operator"},"-"),s("span",{class:"token operator"},">"),n(" TaskiqMessage"),s("span",{class:"token punctuation"},":"),n(`
        `),s("span",{class:"token keyword"},"await"),n(" sleep"),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),n(`
        `),s("span",{class:"token keyword"},"return"),n(` message

    `),s("span",{class:"token keyword"},"async"),n(),s("span",{class:"token keyword"},"def"),n(),s("span",{class:"token function"},"post_save"),s("span",{class:"token punctuation"},"("),n(`
        self`),s("span",{class:"token punctuation"},","),n(`
        message`),s("span",{class:"token punctuation"},":"),n(),s("span",{class:"token string"},'"TaskiqMessage"'),s("span",{class:"token punctuation"},","),n(`
        result`),s("span",{class:"token punctuation"},":"),n(),s("span",{class:"token string"},'"TaskiqResult[Any]"'),s("span",{class:"token punctuation"},","),n(`
    `),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token operator"},"-"),s("span",{class:"token operator"},">"),n(),s("span",{class:"token boolean"},"None"),s("span",{class:"token punctuation"},":"),n(`
        `),s("span",{class:"token keyword"},"await"),n(" sleep"),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),n(`
        `),s("span",{class:"token keyword"},"print"),s("span",{class:"token punctuation"},"("),s("span",{class:"token string"},'"Post save"'),s("span",{class:"token punctuation"},")"),n(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),h=s("p",null,[n("Also, middlewares always have reference to the current broker in "),s("code",null,"self.broker"),n(" field. If you want to kick a message during the execution of some middleware hooks, you may use "),s("code",null,"self.broker"),n(" to do so.")],-1),g={href:"https://github.com/taskiq-python/taskiq-pipelines",target:"_blank",rel:"noopener noreferrer"};function _(q,T){const l=c("ExternalLinkIcon"),i=c("Tabs");return r(),u("div",null,[d,m,s("p",null,[n("Middlewares must implement "),s("a",b,[w,o(l)]),n(" abstract class. Every method of a middleware can be either sync or async. Taskiq will execute it as you expect.")]),y,o(i,{id:"12",data:[{id:"sync"},{id:"async"}]},{title0:e(({value:a,isActive:t})=>[n("sync")]),title1:e(({value:a,isActive:t})=>[n("async")]),tab0:e(({value:a,isActive:t})=>[v]),tab1:e(({value:a,isActive:t})=>[f]),_:1}),h,s("p",null,[s("a",g,[n("Taskiq-pipelines"),o(l)]),n(" uses middlewares to call next tasks.")])])}const N=p(k,[["render",_],["__file","middleware.html.vue"]]),A=JSON.parse(`{"path":"/extending-taskiq/middleware.html","title":"Middlewares","lang":"en-US","frontmatter":{"order":2,"description":"Middlewares Middlewares are super helpful. You can inject some code before or after task's execution. Middlewares must implement taskiq.abc.middleware.TaskiqMiddleware abstract ...","head":[["meta",{"property":"og:url","content":"https://taskiq-python.github.io/extending-taskiq/middleware.html"}],["meta",{"property":"og:site_name","content":"Taskiq"}],["meta",{"property":"og:title","content":"Middlewares"}],["meta",{"property":"og:description","content":"Middlewares Middlewares are super helpful. You can inject some code before or after task's execution. Middlewares must implement taskiq.abc.middleware.TaskiqMiddleware abstract ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-02-05T23:36:31.000Z"}],["meta",{"property":"article:modified_time","content":"2024-02-05T23:36:31.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Middlewares\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-02-05T23:36:31.000Z\\",\\"author\\":[]}"]]},"headers":[],"git":{"createdTime":1707176191000,"updatedTime":1707176191000,"contributors":[{"name":"Pavel Kirilin","email":"win10@list.ru","commits":1}]},"filePathRelative":"extending-taskiq/middleware.md","localizedDate":"February 5, 2024","autoDesc":true,"excerpt":"\\n<p>Middlewares are super helpful. You can inject some code before or after task's execution.</p>\\n<p>Middlewares must implement <a href=\\"https://github.com/taskiq-python/taskiq/blob/master/taskiq/abc/middleware.py\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\"><code>taskiq.abc.middleware.TaskiqMiddleware</code></a> abstract class.\\nEvery method of a middleware can be either sync or async. Taskiq will execute it\\nas you expect.</p>"}`);export{N as comp,A as data};
