import{_ as r,V as u,W as k,Z as e,$ as a,Y as s,a0 as n,D as t}from"./framework-54aca795.js";const d={},m=s("h1",{id:"middlewares",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#middlewares","aria-hidden":"true"},"#"),n(" Middlewares")],-1),b=s("p",null,"Middlewares are super helpful. You can inject some code before or after task's execution.",-1),y=s("p",null,[n("Middlewares must implement "),s("code",null,"taskiq.abc.middleware.TaskiqMiddleware"),n(" abstract class. Every method of a middleware can be either sync or async. Taskiq will execute it as you expect.")],-1),w=s("p",null,"For example:",-1),v=s("div",{class:"language-python line-numbers-mode","data-ext":"py"},[s("pre",{class:"language-python"},[s("code",null,[s("span",{class:"token keyword"},"from"),n(" time "),s("span",{class:"token keyword"},"import"),n(` sleep
`),s("span",{class:"token keyword"},"from"),n(" typing "),s("span",{class:"token keyword"},"import"),n(` Any

`),s("span",{class:"token keyword"},"from"),n(" taskiq "),s("span",{class:"token keyword"},"import"),n(" TaskiqMessage"),s("span",{class:"token punctuation"},","),n(" TaskiqMiddleware"),s("span",{class:"token punctuation"},","),n(` TaskiqResult


`),s("span",{class:"token keyword"},"class"),n(),s("span",{class:"token class-name"},"MyMiddleware"),s("span",{class:"token punctuation"},"("),n("TaskiqMiddleware"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},":"),n(`
    `),s("span",{class:"token keyword"},"def"),n(),s("span",{class:"token function"},"pre_execute"),s("span",{class:"token punctuation"},"("),n("self"),s("span",{class:"token punctuation"},","),n(" message"),s("span",{class:"token punctuation"},":"),n(),s("span",{class:"token string"},'"TaskiqMessage"'),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token operator"},"-"),s("span",{class:"token operator"},">"),n(" TaskiqMessage"),s("span",{class:"token punctuation"},":"),n(`
        sleep`),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),n(`
        `),s("span",{class:"token keyword"},"return"),n(` message

    `),s("span",{class:"token keyword"},"def"),n(),s("span",{class:"token function"},"post_save"),s("span",{class:"token punctuation"},"("),n("self"),s("span",{class:"token punctuation"},","),n(" message"),s("span",{class:"token punctuation"},":"),n(),s("span",{class:"token string"},'"TaskiqMessage"'),s("span",{class:"token punctuation"},","),n(" result"),s("span",{class:"token punctuation"},":"),n(),s("span",{class:"token string"},'"TaskiqResult[Any]"'),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token operator"},"-"),s("span",{class:"token operator"},">"),n(),s("span",{class:"token boolean"},"None"),s("span",{class:"token punctuation"},":"),n(`
        sleep`),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),n(`
        `),s("span",{class:"token keyword"},"print"),s("span",{class:"token punctuation"},"("),s("span",{class:"token string"},'"Post save"'),s("span",{class:"token punctuation"},")"),n(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),f=s("div",{class:"language-python line-numbers-mode","data-ext":"py"},[s("pre",{class:"language-python"},[s("code",null,[s("span",{class:"token keyword"},"from"),n(" asyncio "),s("span",{class:"token keyword"},"import"),n(` sleep
`),s("span",{class:"token keyword"},"from"),n(" typing "),s("span",{class:"token keyword"},"import"),n(` Any

`),s("span",{class:"token keyword"},"from"),n(" taskiq "),s("span",{class:"token keyword"},"import"),n(" TaskiqMessage"),s("span",{class:"token punctuation"},","),n(" TaskiqMiddleware"),s("span",{class:"token punctuation"},","),n(` TaskiqResult


`),s("span",{class:"token keyword"},"class"),n(),s("span",{class:"token class-name"},"MyMiddleware"),s("span",{class:"token punctuation"},"("),n("TaskiqMiddleware"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},":"),n(`
    `),s("span",{class:"token keyword"},"async"),n(),s("span",{class:"token keyword"},"def"),n(),s("span",{class:"token function"},"pre_execute"),s("span",{class:"token punctuation"},"("),n("self"),s("span",{class:"token punctuation"},","),n(" message"),s("span",{class:"token punctuation"},":"),n(),s("span",{class:"token string"},'"TaskiqMessage"'),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token operator"},"-"),s("span",{class:"token operator"},">"),n(" TaskiqMessage"),s("span",{class:"token punctuation"},":"),n(`
        `),s("span",{class:"token keyword"},"await"),n(" sleep"),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),n(`
        `),s("span",{class:"token keyword"},"return"),n(` message

    `),s("span",{class:"token keyword"},"async"),n(),s("span",{class:"token keyword"},"def"),n(),s("span",{class:"token function"},"post_save"),s("span",{class:"token punctuation"},"("),n(`
        self`),s("span",{class:"token punctuation"},","),n(`
        message`),s("span",{class:"token punctuation"},":"),n(),s("span",{class:"token string"},'"TaskiqMessage"'),s("span",{class:"token punctuation"},","),n(`
        result`),s("span",{class:"token punctuation"},":"),n(),s("span",{class:"token string"},'"TaskiqResult[Any]"'),s("span",{class:"token punctuation"},","),n(`
    `),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token operator"},"-"),s("span",{class:"token operator"},">"),n(),s("span",{class:"token boolean"},"None"),s("span",{class:"token punctuation"},":"),n(`
        `),s("span",{class:"token keyword"},"await"),n(" sleep"),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),n(`
        `),s("span",{class:"token keyword"},"print"),s("span",{class:"token punctuation"},"("),s("span",{class:"token string"},'"Post save"'),s("span",{class:"token punctuation"},")"),n(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),_=s("p",null,[n("Also, middlewares always have reference to the current broker in "),s("code",null,"self.broker"),n(" field. If you want to kick a message during the execution of some middleware hooks, you may use "),s("code",null,"self.broker"),n(" to do so.")],-1),g={href:"https://github.com/taskiq-python/taskiq-pipelines",target:"_blank",rel:"noopener noreferrer"};function h(q,T){const o=t("Tabs"),l=t("ExternalLinkIcon");return u(),k("div",null,[m,b,y,w,e(o,{id:"12",data:[{title:"sync"},{title:"async"}]},{tab0:a(({title:c,value:i,isActive:p})=>[v]),tab1:a(({title:c,value:i,isActive:p})=>[f]),_:1}),_,s("p",null,[s("a",g,[n("Taskiq-pipelines"),e(l)]),n(" uses middlewares to call next tasks.")])])}const x=r(d,[["render",h],["__file","middleware.html.vue"]]);export{x as default};
